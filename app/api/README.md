# API Documentation

This document provides detailed descriptions of the API routes in the Simterview application.

## Deepgram API

### `/api/deepgram/authenticate/route.js`

#### `POST()`
**Description:** Retrieves the Deepgram API key from environment variables for client-side use.

**Parameters:** None

**Returns:**
- Success: `{ key: "<API_KEY>" }` - Returns the Deepgram API key 
- Error: DeepgramError object if the API key is not set in environment variables

**Usage:** Used by the client to authenticate with Deepgram's speech-to-speech API.

## Google API

### `/api/google/generate/route.ts`

#### `generateCustomInterview(type, role, length, difficulty, jobDescription, uid)`
**Description:** Generates custom interview content using Google's Generative AI.

**Parameters:**
- `type` (string): The type of interview (e.g., "behavioral" or "technical")
- `role` (string): The job role for the interview (e.g., "Software Engineer")
- `length` (number): The interview duration in minutes
- `difficulty` (string): The difficulty level of the interview (e.g., "Intern", "Junior", "Senior")
- `jobDescription` (string | undefined): Optional job description to tailor the interview questions
- `uid` (string): User ID of the creator

**Returns:**
- Success: `{ success: true, id: string, status: 200 }` - Returns the ID of the newly created interview
- Error: `{ success: false, status: 500, error: error }` - Returns an error object

**Usage:** Used to generate custom interview content based on user specifications and store it in Firestore.

## Interview API

### `/api/interview/post/route.ts`

#### `saveInterviewFeedback({ interviewId, userId, passed, strengths, areasForImprovement, finalAssessment })`
**Description:** Saves or updates interview feedback in Firestore.

**Parameters:**
- Object containing:
  - `interviewId` (string): ID of the interview
  - `userId` (string): ID of the user who took the interview
  - `passed` (boolean): Whether the user passed the interview
  - `strengths` (string): Feedback on the user's strengths
  - `areasForImprovement` (string): Feedback on areas where the user can improve
  - `finalAssessment` (string): Overall assessment of the user's performance

**Returns:**
- Success: `{ success: true, status: 200 }`
- Error: `{ success: false, status: 500 }`

**Usage:** Used to save interview feedback generated by the AI interviewer at the end of an interview session.

## JDoodle API

### `/api/jdoodle/post/route.ts`

#### `runCode({ language, code })`
**Description:** Executes code using the JDoodle API for code compilation and execution.

**Parameters:**
- Object containing:
  - `language` (string): The programming language (e.g., "python", "java", "cpp")
  - `code` (string): The code to execute

**Returns:**
- Success: Object containing:
  - `stdout` (string): Standard output from the code execution
  - `stderr` (string): Standard error (empty if no errors)
  - `memory` (string): Memory usage
  - `cpuTime` (string): CPU time used
- Error: Throws an error with the JDoodle API response text

**Usage:** Used in technical interviews to allow candidates to run their code solutions and get immediate feedback.

## User API

### `/api/user/post/route.ts`

#### `POST(request)`
**Description:** API endpoint to deduct coins from a user's account after an interview.

**Parameters:**
- `request` (Request): HTTP request object containing:
  - `userId` (string): User ID
  - `coinCount` (number): Current coin count
  - `coinCost` (number): Number of coins to deduct

**Returns:**
- Success: `{ success: true }` with status 200
- Error (missing fields): `{ error: 'Missing required fields' }` with status 400
- Error (other): `{ error: 'Failed to deduct coins' }` with status 500

**Usage:** Used to deduct coins from a user's account based on the time spent in an interview session.